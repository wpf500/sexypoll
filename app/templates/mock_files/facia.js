define("modules/ui/snaps",["common/$","bonzo","common/utils/ajax","common/utils/mediator","common/utils/template","common/utils/to-array"],function(t,n,o,e,i,a){function s(){var n=a(t(".facia-snap")).filter(function(t){return t.getAttribute("data-snap-uri")}).filter(function(t){return t.getAttribute("data-snap-type")});n.forEach(l),n.length&&e.on("window:resize",function(){n.forEach(function(t){r(t,!0)})})}function r(t,o){var e=t.offsetWidth,i=n(t),a="facia-snap-point--";[{width:0,name:"tiny"},{width:180,name:"mini"},{width:220,name:"small"},{width:300,name:"medium"},{width:700,name:"large"}].map(function(t,n,i){var a=e>=t.width&&(i[n+1]?e<i[n+1].width:!0);return t.action=a?"addClass":o?"removeClass":!1,t}).filter(function(t){return t.action}).forEach(function(t){i[t.action](a+t.name)})}function c(t){n(t).html(i('<div style="height:{{height}}px; overflow:hidden;"><iframe src="{{src}}" style="height:{{height}}px; width: 100%; border: none;"></iframe></div>',{src:t.getAttribute("data-snap-uri"),height:200}))}function d(e,i){o({url:e.getAttribute("data-snap-uri"),type:i?"json":"html",crossOrigin:!0}).then(function(o){t.create(i?o.html:o).each(function(t){n(e).html(t)})})}function l(t){switch(n(t).addClass("facia-snap-embed"),r(t),t.getAttribute("data-snap-type")){case"document":c(t);break;case"fragment":d(t);break;case"json.html":d(t,!0)}}return{init:s}}),define("modules/ui/container-show-more",["common/$","bonzo","bean","qwery","common/utils/detect","common/utils/mediator"],function(t,n,o,e,i,a){return function(s){this._$container=n(s),this._items=[],this._showCount="mobile"===i.getBreakpoint()?8:1e6,this._className="show-more--hidden",this._$button=n(n.create('<button class="collection__show-more tone-background" data-link-name="Show more | 0"><span class="collection__show-more__icon"><span class="i i-plus-white-mask"></span><span class="i i-plus-white"></span></span><span class="u-h">Show more</span></button>')),this._renderButton=function(){if(this._$button.addClass("tone-"+(this._$container.attr("data-tone")||"news")).insertAfter(this._$container),this._$container.hasClass("container--show-more-dark")){var n=t(".i",this._$button);t(n.get(0)).removeClass("i-plus-white-mask").addClass("i-plus-neutral1-mask"),t(n.get(1)).removeClass("i-plus-white").addClass("i-plus-neutral1")}o.on(this._$button[0],"click",this.showMore.bind(this)),a.emit("modules:containerShowMore:renderButton",this)},this._removeButton=function(){a.on("module:clickstream:click",function(t){e(t.target)[0]===this._$button[0]&&this._$button.remove()}.bind(this))},this._incrementButtonCounter=function(){var t=this._$button.attr("data-link-name").replace(/^(.* | )(\d+)$/,function(t,n,o){return n+(parseInt(o,10)+1)});this._$button.attr("data-link-name",t)},this.showMore=function(){this._$button.attr("disabled",!0),this._$container.removeClass(this._className),n(this._items.splice(0,this._showCount)).removeClass(this._className),this._incrementButtonCounter(),0===this._items.length?this._removeButton():this._$button.attr("disabled",!1)},this.addShowMore=function(){this._$container.addClass(this._className),this._items=t(".linkslist > .linkslist__item",this._$container).addClass(this._className).map(function(t){return t}),this._renderButton(),this._$container.removeClass("js-container--show-more")}}}),define("modules/ui/container-toggle",["common/$","bonzo","bean","common/modules/userPrefs"],function(t,n,o,e){return function(i){var a=n(i),s=n(n.create('<button class="container__toggle" data-link-name="Show"><i class="i i-arrow-white-large"></i><span class="container__toggle__text">Hide</span></button>')),r="container-states",c={hidden:"Show",displayed:"Hide"},d="displayed",l=function(t,n){var o=e.get(r),i=t.attr("data-id");"displayed"===n?delete o[i]:(o||(o={}),o[i]="closed"),e.set(r,o)},u=function(t){var n=e.get(r);n&&n[t.attr("data-id")]&&o.fire(s[0],"click")};e.remove("front-trailblocks"),this.addToggle=function(){t(".container__header",a[0]).append(s),a.removeClass("js-container--toggle"),o.on(s[0],"click",function(){d="displayed"===d?"hidden":"displayed",a["displayed"===d?"removeClass":"addClass"]("container--rolled-up"),s.attr("data-link-name",c["displayed"===d?"hidden":"displayed"]),t(".container__toggle__text",s[0]).text(c[d]),t(".ad-slot--paid-for-badge",i).css("display","hidden"===d?"none":"block"),l(a,d)}),u(a)}}}),define("modules/onwards/geo-most-popular-front",["qwery","lodash/objects/assign","common/modules/component","common/modules/analytics/register"],function(t,n,o,e){function i(o,i){e.begin("most-popular"),this.config=n(this.config,i),this.mediator=o,this.manipulationType="html",this.go=function(){var n=t(".js-popular-trails")[0];n&&this.fetch(n,"html")}}return o.define(i),i.prototype.endpoint="http://api.nextgen.guardianapps.co.uk/most-read-geo.json",i.prototype.ready=function(){e.end("most-popular")},i}),define("bootstraps/facia",["common/$","common/utils/ajax","common/utils/mediator","bonzo","qwery","common/utils/detect","common/utils/storage","common/utils/to-array","common/modules/ui/collection-show-more","modules/ui/snaps","modules/ui/container-show-more","modules/ui/container-toggle","modules/onwards/geo-most-popular-front"],function(t,n,o,e,i,a,s,r,c,d,l,u,m){var h={showSnaps:function(){d.init()},showCollectionShowMore:function(){var n=function(n,o){var e=o||document;t(".container",e).each(function(n){t(".js-collection--show-more",n).each(function(t){new c(t).addShowMore()})}),t(".js-container--show-more",e).each(function(t){new l(t).addShowMore()})};o.addListeners({"page:front:ready":n,"ui:collection-show-more:add":n})},showContainerToggle:function(){var n=function(n,o){var e=o||document;t(".js-container--toggle",e).each(function(t){new u(t).addToggle()})};o.addListeners({"page:front:ready":n,"ui:container-toggle:add":n}),o.on(/page:front:ready|ui:container-toggle:add/,function(n,o){t(".js-container--toggle",o).each(function(t){new u(t).addToggle()})})},upgradeMostPopularToGeo:function(t){"Network Front"===t.page.contentType&&t.switches.geoMostPopular&&new m(o,t).go()}},p=function(t,n){this.initialised||(this.initialised=!0,h.showSnaps(),h.showCollectionShowMore(),h.showContainerToggle(),h.upgradeMostPopularToGeo(t)),o.emit("page:front:ready",t,n)};return{init:p}});
//# sourceMappingURL=facia.js.map